<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.0.52/wavesurfer.min.js"></script>
<script src="https://seangreene.github.com/bn-biodiversity/js/howler.min.js"></script>

<style>
	h3{
		font-family: "Open Sans", sans-serif;
	}
	.sound {
		position: relative;
		margin: 15px auto;
		padding-bottom: 15px;
    	max-width: 600px;
    	text-align: center;
    	border-top: 2px #666666 solid;
    	border-bottom: 2px #666666 solid;
	}
	.sound i {
		color: #666666;
		font-size: 100px;	
	}
	.sound i:hover {
		opacity: 0.6;
		cursor: pointer;
	}
	.audio-controller {
		margin-top: 15px;
		margin-bottom: 15px;
	}
	.sound figcaption {
		text-align: center;
		width: 60%;
		margin-right: auto;
   		margin-left: auto;
	}

</style>

<div class="sound">
	
	<h3><strong>Listen:</strong> The Call of the Clapper Rail									
	<div class="audio-controller">
		<i class="fa fa-play"></i>
	</div>

	<div id="wave"></div>

	<figcaption>The kek-burr call of the California clapper rail, recorded by Jules Evens in Napa County.</figcaption>
</div>




<script>

	//sound player
	$(document).ready(function(){
		var wavesurfer = WaveSurfer.create({
		    container: '#wave',
		    waveColor: '#fdaaaa',
		    progressColor: '#ff0000'
		});

		var sound = new Howl({

			//note to self: can declare .ogg file here using comma
			urls: ['https://dh1rvgpokacch.cloudfront.net/atavist/9410/audio/raw/kekburcut-1403296688-31.mp3', 'http://baynature.org/wp-content/uploads/2016/03/clapperrail.ogg'],
			volume: 0.5,
		 //    onend: function() {
			//     $('i').replaceWith('<i class="fa fa-play"></i>');
			//     $('.audio-controller').removeClass('playing');
			//   },
		 //    onplay: function() {
			//     $('i').replaceWith('<i class="fa fa-pause"></i>');
			//     $('.audio-controller').addClass('playing');
			//   },
			// onpause: function(){
			//     $('i').replaceWith('<i class="fa fa-play"></i>');
			//     $('.audio-controller').removeClass('playing');					 
			// },
			// onloaderror: function(){
			//     $('i').replaceWith('<p style="font-family:Arial, sans-serif;">Sorry! This sound failed to load.</p>');
			// }
		});

		wavesurfer.load(sound['_src']);
		//wavesurfer.setVolume(0.5);

		wavesurfer.on('play', function(){
			    $('i').replaceWith('<i class="fa fa-pause"></i>');
			    $('.audio-controller').addClass('playing');
		});
		wavesurfer.on('pause', function(){
			    $('i').replaceWith('<i class="fa fa-play"></i>');
			    $('.audio-controller').removeClass('playing');	
		});
		wavesurfer.on('error', function(){
			    $('i').replaceWith('<p style="font-family:Arial, sans-serif;">Sorry! This sound failed to load.</p>');
		});
		wavesurfer.on('finish', function(){
			    $('i').replaceWith('<i class="fa fa-play"></i>');
			    $('.audio-controller').removeClass('playing');
		});		
		$('.audio-controller').on('click', function(){
		    if ( $(this).hasClass("playing") ) {
		    	//sound.pause();
		    	wavesurfer.pause();
		    } else {
				//sound.stop().play();
				wavesurfer.play();
		    }
		});
		
	})

</script>